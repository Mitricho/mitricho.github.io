<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- qt3dxr-multiview.qdoc -->
  <meta name="description" content="This page describes the concepts and practical implications of multiview rendering support in Qt Quick 3D.">
  <title>Multiview Rendering | Qt Quick 3D | Qt 6.9.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li>Qt 6.9</li>
<li><a href="qtquick3d-index.html">Qt Quick 3D</a></li>
<li>Multiview Rendering</li>
<li id="buildversion"><a href="qtquick3d-index.html">Qt Quick 3D | Commercial or GPLv3</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#low-level-overview">Low-Level Overview</a></li>
<li class="level2"><a href="#multiview-support-in-3d-apis">Multiview support in 3D APIs</a></li>
<li class="level2"><a href="#multiview-support-in-qt-s-rendering-hardware-interface-rhi">Multiview support in Qt's rendering hardware interface (RHI)</a></li>
<li class="level1"><a href="#multiview-support-in-the-qt-quick-quick-3d-quick-3d-xr-stack">Multiview Support in the Qt Quick - Quick 3D - Quick 3D XR Stack</a></li>
<li class="level2"><a href="#multiview-support-in-qt-quick">Multiview support in Qt Quick</a></li>
<li class="level2"><a href="#multiview-support-in-qt-quick-3d">Multiview support in Qt Quick 3D</a></li>
<li class="level2"><a href="#multiview-support-in-qt-quick-3d-xr">Multiview support in Qt Quick 3D Xr</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Multiview Rendering</h1>
<!-- $$$qt3dxr-multiview.html-description -->
<div class="descr" id="details">
<p>Multiview rendering refers to instancing draw calls into layers of a 2D texture array. In Qt, it is relevant, in particular for VR/AR applications built with Qt Quick 3D Xr. Instead of independently doing scene traversal, rendering preparations, and render pass recording for the left and right eye's content, multiview rendering allows doing it once, with the draw calls in the single render pass being instanced into layers 0 and 1 of a texture array. The vertex shader uses a special variable indicating the view index and computes per-view values based on that. Uniforms that contain view-dependent data, such as camera matrices, must be provided for both eyes. Multiview rendering is expected to decrease the renderer's load on the system, potentially leading to better performance. It comes at the expense of having to make the renderer and shaders aware of working with view-dependent data and texture array as appropriate.</p>
<h2 id="low-level-overview">Low-Level Overview</h2>
<p>Qt application developers do not necessarily need a full understanding of how multiview rendering is enabled on the lower levels of the Qt rendering stack. The following links are provided for developers wishing to look more into the details under the hood.</p>
<h3 id="multiview-support-in-3d-apis">Multiview support in 3D APIs</h3>
<p>Multiview rendering is available only when the underlying 3D API supports it at run time. For details, see the appropriate specifications and documentation:</p>
<ul>
<li>OpenGL: <a href="https://registry.khronos.org/OpenGL/extensions/OVR/OVR_multiview.txt">OVR_multiview1</a> and <a href="https://registry.khronos.org/OpenGL/extensions/OVR/OVR_multiview2.txt">OVR_multiview2</a></li>
<li>Vulkan: <a href="https://registry.khronos.org/vulkan/specs/1.3-extensions/man/html/VK_KHR_multiview.html">VK_KHR_multiview</a></li>
<li>Direct 3D 12: <a href="https://microsoft.github.io/DirectX-Specs/d3d/ViewInstancing.html">ViewInstancing</a></li>
<li>Metal: <a href="https://developer.apple.com/documentation/metal/render_passes/rendering_to_multiple_texture_slices_in_a_draw_command">rendering_to_multiple_texture_slices</a></li>
</ul>
<h3 id="multiview-support-in-qt-s-rendering-hardware-interface-rhi">Multiview support in Qt's rendering hardware interface (RHI)</h3>
<p>In Qt, the 3D graphics APIs are abstracted by the <a href="../qtgui/qrhi.html" translate="no">QRhi</a> class. Qt Quick and Qt Quick 3D uses this infrastructure for all their accelerated rendering. See the following for further low-level information on multiview rendering support:</p>
<ul>
<li><a href="../qtgui/qrhi.html#Feature-enum" translate="no">QRhi::MultiView</a></li>
<li><a href="../qtgui/qrhicolorattachment.html#setMultiViewCount" translate="no">QRhiColorAttachment::setMultiViewCount</a>()</li>
<li><a href="../qtgui/qrhigraphicspipeline.html#setMultiViewCount" translate="no">QRhiGraphicsPipeline::setMultiViewCount</a>()</li>
</ul>
<h2 id="multiview-support-in-the-qt-quick-quick-3d-quick-3d-xr-stack">Multiview Support in the Qt Quick - Quick 3D - Quick 3D XR Stack</h2>
<h3 id="multiview-support-in-qt-quick">Multiview support in Qt Quick</h3>
<p>Qt Quick is multiview-aware, but is never using multiview rendering on its own. Supporting multiview rendering becomes important in combination with Qt Quick 3D when 2D elements are embedded into the 3D scene. To render the 2D content correctly when the 3D scene is output to a multiview render target, the 2D renderer and its materials (shaders) must be prepared for multiview support.</p>
<p>Developers of Qt-based applications do not need to take this into consideration in many cases because Qt Quick's built-in materials that items such as <a href="../qtquick/qml-qtquick-rectangle.html" translate="no">Rectangle</a>, <a href="../qtquick/qml-qtquick-image.html" translate="no">Image</a>, or <a href="../qtquick/qml-qtquick-text.html" translate="no">Text</a> are built on are all multiview compatible.</p>
<p>However, when developing custom materials (<a href="../qtquick/qsgmaterial.html" translate="no">QSGMaterial</a>, <a href="../qtquick/qsgmaterialshader.html" translate="no">QSGMaterialShader</a>) or writing shaders for <a href="../qtquick/qml-qtquick-shadereffect.html" translate="no">ShaderEffect</a>, and the intention is to use that 2D content within a VR/AR scene in a Qt Quick 3D Xr application, the custom content must be multiview-aware. see <a href="../qtquick/qsgmaterial.html#viewCount" translate="no">QSGMaterial::viewCount</a>() for details on this.</p>
<p>Writing multiview-aware shaders is enabled by Qt's shader conditioning pipeline. See the Multiview sections in <a href="../qtshadertools/qtshadertools-qsb.html">QSB Manual</a> and <a href="../qtshadertools/qtshadertools-build.html">Qt Shader Tools Build System Integration</a> for details.</p>
<h3 id="multiview-support-in-qt-quick-3d">Multiview support in Qt Quick 3D</h3>
<p>Qt Quick 3D applications that do not use Qt Quick 3D Xr, meaning they are not VR/AR applications, cannot currently use multiview rendering. The 3D renderer is fully multiview-capable, however, since Qt Quick 3D Xr is built on the same infrastructure. All standard, built-in features, such as <a href="qml-qtquick3d-model.html" translate="no">Model</a> or <a href="qml-qtquick3d-principledmaterial.html" translate="no">PrincipledMaterial</a> are fully multiview compatible. Some deprecated functionality, such as the old standalone effects module, may not support multiview rendering.</p>
<p>When custom shader snippets are involved in a <a href="qml-qtquick3d-custommaterial.html" translate="no">CustomMaterial</a> or <a href="qml-qtquick3d-effect.html" translate="no">Effect</a>, the application-provided shader code needs to be written with multiview support in mind in order to function correctly in a Qt Quick 3D Xr application with multiview rendering enabled. See the documentation of these types on how to achieve this. The special keywords for which this is particularly important are <code translate="no">VIEW_INDEX</code>, <code translate="no">INPUT</code>, <code translate="no">SCREEN_TEXTURE</code>, <code translate="no">DEPTH_TEXTURE</code>, <code translate="no">AO_TEXTURE</code>.</p>
<p>For example, the following postprocessing effect is multiview compatible, because it is prepared for the case when <code translate="no">INPUT</code> is a <code translate="no">sampler2DArray</code> instead of a <code translate="no">sampler2D</code>:</p>
<pre class="cpp plain" translate="no">
 void MAIN()
 {
     vec4 c = texture(someTexture, TEXTURE_UV);
     // ...
 #if QSHADER_VIEW_COUNT &gt;= 2
     FRAGCOLOR = c * texture(INPUT, vec3(INPUT_UV, VIEW_INDEX));
 #else
     FRAGCOLOR = c * texture(INPUT, INPUT_UV);
 #endif
 }
</pre>
<h3 id="multiview-support-in-qt-quick-3d-xr">Multiview support in Qt Quick 3D Xr</h3>
<p>Multiview rendering is <b>enabled</b> by default, as long as the underlying graphics API supports it. This is done to ensure the best possible performance. To query if multiview rendering is supported, check the <a href="qml-qtquick3d-xr-xrview.html#multiViewRenderingSupported-prop" translate="no">multiViewRenderingSupported</a> property.</p>
<p>For development and testing purposes, it can be useful to disable the usage of multiview rendering. This is done by setting the environment variable <code translate="no">QT_QUICK3D_XR_DISABLE_MULTIVIEW</code> to a non-zero value.</p>
<p>To query if multiview rendering is enabled, use the <a href="qml-qtquick3d-xr-xrview.html#multiViewRenderingEnabled-prop" translate="no">multiViewRenderingEnabled</a> property. The value stays false always if multiview rendering cannot be enabled.</p>
<p>In general, it is recommended that VR/AR applications leave multiview rendering enabled when it's supported, and only disable it when experiencing problems, or for testing purposes. Multiview rendering is expected to improve performance, reducing the GPU and especially the CPU load.</p>
</div>
<!-- @@@qt3dxr-multiview.html -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <abbr title="Copyright">&copy;</abbr> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
