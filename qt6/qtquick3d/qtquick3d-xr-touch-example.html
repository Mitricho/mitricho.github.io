<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- qtquick3d-examples-xrtouch.qdoc -->
  <meta name="description" content="Demonstrates hand-tracking input in Qt Quick 3D Xr.">
  <title>Qt Quick 3D - XR Simple Touch Example | Qt Quick 3D | Qt 6.9.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li>Qt 6.9</li>
<li><a href="qtquick3d-index.html">Qt Quick 3D</a></li>
<li><a href="quick3d-examples.html">Qt Quick 3D Examples and Tutorials</a></li>
<li>Qt Quick 3D - XR Simple Touch Example</li>
<li id="buildversion"><a href="qtquick3d-index.html">Qt Quick 3D | Commercial or GPLv3</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar"><div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Qt Quick 3D - XR Simple Touch Example</h1>
<!-- $$$xr_touch-brief -->
<p>Demonstrates hand-tracking input in Qt Quick 3D Xr.</p>
<!-- @@@xr_touch -->
<!-- $$$xr_touch-description -->
<div class="descr" id="details">
<p class="centerAlign"><img src="images/xrtouch-example.jpg" alt="" /></p><p>This example shows how to use the hand-tracking API in Qt Quick 3D Xr to interact with 2D and 3D objects in the scene. It follows the basic structure of the <a href="qtquick3d-xr-simple-example.html">xr_simple</a> example.</p>
<p>Since we need to support two hands, we start by creating a component that encapsulates all the logic that we need for each hand to avoid repetition:</p>
<pre class="qml" translate="no">
 component Hand : <span class="type"><a href="qml-qtquick3d-node.html" translate="no">Node</a></span> {
     <span class="name">id</span>: <span class="name">handComponentRoot</span>
     property <span class="type"><a href="../qtquick/qml-color.html" translate="no">color</a></span> <span class="name">color</span>: <span class="string">&quot;#ddaa88&quot;</span>
     required property <span class="type"><a href="../qtqml/qml-int.html" translate="no">int</a></span> <span class="name">touchId</span>
     property <span class="type">alias</span> <span class="name">hand</span>: <span class="name">handModel</span>.<span class="name">hand</span>

     property <span class="type"><a href="../qtquick/qml-vector3d.html" translate="no">vector3d</a></span> <span class="name">touchPosition</span>: <span class="name">handController</span>.<span class="name">pokePosition</span>
     <span class="name">onTouchPositionChanged</span>: {
         const scenePos = <span class="name">theOrigin</span>.<span class="name">mapPositionToScene</span>(<span class="name">touchPosition</span>)
         const touchOffset = <span class="name">xrView</span>.<span class="name">processTouch</span>(<span class="name">scenePos</span>, <span class="name">handComponentRoot</span>.<span class="name">touchId</span>)
         <span class="name">handModel</span>.<span class="name">position</span> <span class="operator">=</span> <span class="name">touchOffset</span>
         <span class="name">buttons</span>.<span class="name">handleTouch</span>(<span class="name">scenePos</span>)
     }

     <span class="type"><a href="qml-qtquick3d-xr-xrcontroller.html" translate="no">XrController</a></span> {
         <span class="name">id</span>: <span class="name">handController</span>
         <span class="name">controller</span>: <span class="name">handComponentRoot</span>.<span class="name">hand</span>
     }
     <span class="type"><a href="qml-qtquick3d-xr-xrhandmodel.html" translate="no">XrHandModel</a></span> {
         <span class="name">id</span>: <span class="name">handModel</span>
         <span class="name">materials</span>: <span class="name">PrincipledMaterial</span> {
             <span class="name">baseColor</span>: <span class="name">handComponentRoot</span>.<span class="name">color</span>
             <span class="name">roughness</span>: <span class="number">0.5</span>
         }
     }
 }
</pre>
<p>The component contains an <a href="qml-qtquick3d-xr-xrcontroller.html" translate="no">XrController</a>, giving us the 3D position of the index finger, and an <a href="qml-qtquick3d-xr-xrhandmodel.html" translate="no">XrHandModel</a> to show where the hand is. The <code translate="no">onTouchPositionChanged</code> handler is where the magic happens. We call <a href="qml-qtquick3d-xr-xrview.html#processTouch-method" translate="no">XrView.processTouch</a>(), which does the heavy lifting: It tries to map the 3D touch position to a 2D position on an <a href="qml-qtquick3d-xr-xritem.html" translate="no">XrItem</a> and sends a touch event if it finds an item. It then returns the offset from the 3D position to the touch point on the 2D surface. We then use that offset to shift the position of the <a href="qml-qtquick3d-xr-xrhandmodel.html" translate="no">XrHandModel</a>, to give the illusion that the hand is stopped by the surface.</p>
<div class="admonition note">
<p><b>Note: </b>This effect will not work on the Apple Vision Pro since the system shows the real hands of the user, and the <a href="qml-qtquick3d-xr-xrhandmodel.html" translate="no">XrHandModel</a> is not shown.</p>
</div>
<p>Finally, we do the 3D interaction. Here, <code translate="no">buttons</code> is a group of 3D buttons that has a <code translate="no">handleTouch</code> function. (The implementation is not XR specific, so the details are not documented here.)</p>
<p>We create two instances of the hand component inside the <a href="qml-qtquick3d-xr-xrorigin.html" translate="no">XrOrigin</a>, one for each hand:</p>
<pre class="qml" translate="no">
 <span class="type"><a href="qml-qtquick3d-xr-xrorigin.html" translate="no">XrOrigin</a></span> {
     <span class="name">id</span>: <span class="name">theOrigin</span>
     <span class="name">z</span>: <span class="number">50</span>
     <span class="type">Hand</span> {
         <span class="name">id</span>: <span class="name">rightHandModel</span>
         <span class="name">hand</span>: <span class="name">XrHandModel</span>.<span class="name">RightHand</span>
         <span class="name">touchId</span>: <span class="number">0</span>
     }
     <span class="type">Hand</span> {
         <span class="name">id</span>: <span class="name">leftHandModel</span>
         <span class="name">hand</span>: <span class="name">XrHandModel</span>.<span class="name">LeftHand</span>
         <span class="name">touchId</span>: <span class="number">1</span>
     }
 }
 <span class="name">xrOrigin</span>: <span class="name">theOrigin</span>
</pre>
<p>We also position the origin 50 centimeters from the origin of the scene, which should be a comfortable touching distance.</p>
<p>The rest of the scene contains some 3D models and an <a href="qml-qtquick3d-xr-xritem.html" translate="no">XrItem</a> that reacts to touch events.</p>
<p><a href="https://code.qt.io/cgit/qt/qtquick3d.git/tree/examples/quick3d/xr_touch?h=6.9">Example project @ code.qt.io</a></p>
</div>
<!-- @@@xr_touch -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <abbr title="Copyright">&copy;</abbr> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
