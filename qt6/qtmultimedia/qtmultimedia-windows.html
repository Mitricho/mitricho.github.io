<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<!-- platform-notes-windows.qdoc -->
  <meta name="description" content="Platform notes for Windows">
  <title>Qt Multimedia on Windows | Qt Multimedia | Qt 6.9.0</title>
  <link rel="stylesheet" type="text/css" href="style/offline-simple.css" />
  <script type="text/javascript">
    document.getElementsByTagName("link").item(0).setAttribute("href", "style/offline.css");
    // loading style sheet breaks anchors that were jumped to before
    // so force jumping to anchor again
    setTimeout(function() {
        var anchor = location.hash;
        // need to jump to different anchor first (e.g. none)
        location.hash = "#";
        setTimeout(function() {
            location.hash = anchor;
        }, 0);
    }, 0);
  </script>
</head>
<body>
<div class="header" id="qtdocheader">
    <div class="main">
    <div class="main-rounded">
        <div class="navigationbar">
        <ul>
<li>Qt 6.9</li>
<li><a href="qtmultimedia-index.html">Qt Multimedia</a></li>
<li>Qt Multimedia on Windows</li>
<li id="buildversion"><a href="qtmultimedia-index.html">Qt 6.9.0 Reference Documentation</a></li>
    </ul>
    </div>
</div>
<div class="content">
<div class="line">
<div class="content mainContent">
<div class="sidebar">
<div class="toc">
<h3 id="toc">Contents</h3>
<ul>
<li class="level1"><a href="#notes-on-com">Notes on COM</a></li>
</ul>
</div>
<div class="sidebar-content" id="sidebar-content"></div></div>
<h1 class="title">Qt Multimedia on Windows</h1>
<!-- $$$qtmultimedia-windows.html-description -->
<div class="descr" id="details">
<p>This page discusses considerations for using Qt Multimedia on Windows.</p>
<h2 id="notes-on-com">Notes on COM</h2>
<p>Qt Multimedia uses COM APIs from the Windows platform. This requires COM to be initialized on the threads that access Qt Multimedia APIs. Although Qt Multimedia APIs will automatically initialize COM as needed, we recommend initializing the <a href="../qtgui/qguiapplication.html" translate="no">QGuiApplication</a> instance from the main thread during application startup before making any calls to Qt Multimedia APIs. This ensures that the main single threaded apartment (main STA) is initialized before Qt Multimedia APIs are called from any thread. This also guarantees that the main STA is not uninitialized until all other apartments have shut down.</p>
<p>Qt Multimedia APIs that require COM will initialize the thread as a single-threaded apartment by calling <code translate="no">CoInitializeEx(nullptr, COINIT_APARTMENT_THREADED)</code>, and <code translate="no">CoUninitialize</code> will not be called until the thread exits. This applies to the main application thread as well, where <code translate="no">CoUninitialize</code> is called during the destruction of static variables.</p>
</div>
<!-- @@@qtmultimedia-windows.html -->
        </div>
       </div>
   </div>
   </div>
</div>
<div class="footer">
   <p>
   <abbr title="Copyright">&copy;</abbr> 2024 <span translate="no">The Qt Company Ltd.</span>
   Documentation contributions included herein are the copyrights of
   their respective owners.<br/>    The documentation provided herein is licensed under the terms of the    <a href="http://www.gnu.org/licenses/fdl.html">GNU Free Documentation    License version 1.3</a> as published by the <span translate="no">Free Software Foundation</span>.<br/>    <span translate="no">Qt</span> and respective logos are <a href="https://doc.qt.io/qt/trademarks.html">    trademarks</a> of <span translate="no">The Qt Company Ltd.</span> in Finland and/or other countries
   worldwide. All other trademarks are property of their respective owners. </p>
</div>
</body>
</html>
